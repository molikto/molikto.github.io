<!DOCTYPE html><html><head><meta charset="UTF-8" /><link rel="alternate" type="application/atom+xml" href="https://molikto.github.io/feed.xml" title="molikto’s weblog" /><link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap-reboot.min.css" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Gentium+Book+Basic:400,400i,700|Roboto" rel="stylesheet" type="text/css" /><link href="/resources/solarized-dark.css" rel="stylesheet" type="text/css" /><link href="/resources/blog.css" rel="stylesheet" type="text/css" /><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" rel="stylesheet" type="text/css" /><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js"></script><script src="/resources/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><title>Type class elaboration</title><meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" /></head><body><div id="body"><h1><a href="/">molikto’s weblog</a></h1><div><a class="time" href="https://github.com/molikto/blog/commits/master/markdown/posts/2021-01-16.md"><time datetime="2021-01-16T17:52:21+08:00">2021-01-16</time></a></div><h2>Type class elaboration</h2><ul>
<li>
<p>Q: How to implement typeclasses in proof assistants (Coq, Lean).</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=6WhFpnfD-Tw">video</a> of the basics
<ul>
<li>Haskell
<ul>
<li>apartness</li>
<li>coherence: all instances are the same</li>
<li>it is used to ensure code correctness (sorted map with insert and union)
<ul>
<li>How Scala handles it if you union two sorted map with different order instances: it doesn&rsquo;t care if the second parameter is sorted or not, <a href="https://www.scala-lang.org/api/current/scala/collection/SortedMap.html#++[V2%3E:V](xs:scala.collection.IterableOnce[(K,V2)]):CC[K,V2]">link</a></li>
<li>in video: it should use dependent type, the SortedMap depends on the order</li>
</ul>
</li>
</ul>
</li>
<li>Scala
<ul>
<li><a href="https://github.com/lampepfl/dotty-feature-requests/issues/4">this issue</a></li>
</ul>
</li>
</ul>
</li>
<li>(Tabled Type class Resolution)[https://arxiv.org/abs/2001.04301]</li>
</ul>
</li>
<li>
<p>Q: How is extension methods implemented</p>
<ul>
<li>Are they just baby typeclasses? No, because they can have different types. It is called ad-hoc overloading in <a href="https://arxiv.org/abs/1505.04324">Elaboration in Dependent Type Theory</a> and <a href="https://github.com/leanprover/lean4/blob/d3d245c711bba039ddf2f7e35ce483505aa2970e/tests/elabissues/overload_with_list_coercion.lean#L1">this</a></li>
</ul>
</li>
<li>
<p>Q: Again, how the elaborator as a whole works: integrate meta solving, type class resolution, ad-hoc overloading and coercions?</p>
<ul>
<li>The Lean 2 paper seems not apply very well to Lean 4 implementation</li>
</ul>
</li>
<li>
<p>Overview of Lean 4 source code</p>
<ul>
<li><a href="http://leanprover.github.io/talks/vu2019.pdf">slides from 2019</a>
<ul>
<li>outdated, compiler is in Lean</li>
</ul>
</li>
<li><a href="http://leanprover.github.io/talks/LeanACL2.pdf">slides from 2020</a>
<ul>
<li>the object header is 1 word, it use 64bits to encode a lot of information</li>
</ul>
</li>
<li><a href="https://github.com/leanprover/lean4">Lean 4</a> repo <code>/src</code></li>
<li><code>Lean</code> is the elaborator &amp; compiler of Lean implemented in Lean
<ul>
<li><code>Compiler</code> backend</li>
<li><code>Elab</code> is the elaborator
<ul>
<li><code>PreDefinition</code> is termination checking, or translation to eliminators</li>
</ul>
</li>
<li><code>Meta</code> is meta solving and all that</li>
<li><code>Parser</code> is the extensible parsers and all that</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Lean4 changed its naming convention from <code>snake_case</code> to <code>camelCase</code>??!!</p>
</li>
</ul>
<script>
renderMathInElement(
  document.body,
  {
    delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false}
    ]
  }
);
</script>
<div style="margin-top:64px;"/>
<script src="https://utteranc.es/client.js"
  repo="molikto/molikto.github.io"
  issue-term="pathname"
  theme="github-dark-orange"
  crossorigin="anonymous"
  async>
</script>
          </div></body></html>